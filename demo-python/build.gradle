task purge(type:Delete){
    delete 'build'
}

task dependance(type:Exec, dependsOn:purge){
    executable 'sh'
    args '-c', 'pip install -r src/requirements.txt'
      standardOutput = new ByteArrayOutputStream()

      //extension method execSomething.output() can be used to obtain the output:
      ext.output = {
        return standardOutput.toString()
      }}

task test(type:Exec, dependsOn:dependance){
    executable 'sh'
    args '-c', 'python3 -m pytest src/tests/tests.py'
      standardOutput = new ByteArrayOutputStream()

      //extension method execSomething.output() can be used to obtain the output:
      ext.output = {
        return standardOutput.toString()
      }}

task packageDistribution(type:Zip, dependsOn:test){
    from('src') into ('.')
    archiveFileName = 'demo-python.zip'
    destinationDirectory = file('build')
}
